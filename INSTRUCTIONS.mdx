# Test de Composant React (Testing librairie)

### ğŸ’¡ Description longue de l'exercice

## ğŸ“ Tes notes

Detaille ce que tu as appris ici,Â surÂ uneÂ pageÂ [Notion](https://go.mikecodeur.com/course-notes-template)

## Comprendre

Pour tester les composants `React` avec `testing librairie` il faut utiliser [`render`](https://testing-library.com/docs/react-testing-library/api/#render) pour effectuer le rendu du composant , ensuite on pour tester avec [`screen`](https://testing-library.com/docs/queries/about/)

```tsx
import {render, screen} from '@testing-library/react'

describe('Composant', () => {
  const setup = () => render(<Component/>)
  screen.getAllByText(/value/)
  ...
 })
```

ğŸ“‘ Le liens vers la doc [https://testing-library.com/docs/queries/about/](https://testing-library.com/docs/queries/about/)

## Exercice

Dans cet exercice tu vas devoir tester le composant `Home` les tests

- Le titre de la page d'accueil est correct
- L'auteur de la page d'accueil est correct
- VÃ©rifie la prÃ©sence du lien Instructions
- VÃ©rifie la prÃ©sence du lien de connexion

Fichiers

- `exercise/about/page`

## Bonus

### 1. ğŸš€ Test Hook (Context API)

Dans cet exercice, nous allons apprendre Ã  tester des composants utilisant le **Context API** et des hooks React, en combinant `@testing-library/react` avec `renderHook`. Nous allons travailler sur l'exemple d'un systÃ¨me de thÃ¨me basÃ© sur le contexte, oÃ¹ l'utilisateur peut basculer entre les modes `light`, `dark`, et `system`. L'objectif est d'Ã©crire des tests unitaires pour garantir que le contexte fonctionne correctement.

Les concepts clÃ©s que nous allons aborder :

1. **Configurer un environnement de test mock** (comme `matchMedia`).
2. **Utiliser `renderHook`** pour tester des hooks isolÃ©s.
3. **Simuler des actions utilisateur** avec `act` pour modifier le contexte.
4. **Nettoyer les effets secondaires** pour s'assurer de tests indÃ©pendants.

### **2. PrÃ©parer le contexte**

Vous devez avoir un fichier de contexte, comme `WrapperContext`, qui fournit le thÃ¨me Ã  l'ensemble de l'application. Exemple simplifiÃ© :

```tsx

import {ThemeProvider} from 'next-themes';
import React, {ReactNode} from 'react';

export const WrapperContext = ({children}: {children: ReactNode}) => {
  return <ThemeProvider>{children}</ThemeProvider>;
};

```

### **3. Ã‰crire ls tests**

Le fichier de test est organisÃ© en trois Ã©tapes :

1. **Initialiser `matchMedia` :** Simule le comportement du navigateur pour les requÃªtes mÃ©dia.
2. **Tester le thÃ¨me par dÃ©faut :** VÃ©rifie que le contexte est initialisÃ© avec la valeur par dÃ©faut `system`.
3. **Tester les changements de thÃ¨me :** Simule l'appel de `setTheme` pour passer Ã  `light` ou `dark`.

Voici une description dÃ©taillÃ©e des tests :

### **Test 1 : Le thÃ¨me par dÃ©faut est `system`**

```tsx
it("Theme default is 'system'", async () => {
  const {result: themeResult} = renderHook(() => useTheme(), {
    wrapper: WrapperContext,
  });
  expect(themeResult.current.theme).toBe('system');
});

```

- Utilise `renderHook` pour tester `useTheme` dans le contexte de `WrapperContext`.
- VÃ©rifie que la valeur initiale de `theme` est bien `system`.

Test 2 : Changer le thÃ¨me en `light`

Test 3 : Changer le thÃ¨me en `dark`

### **Conseils pour l'exercice**

1. **Nettoyage entre les tests :**
   - Utilise `beforeEach` pour configurer `matchMedia`.
   - Utilise `afterEach` pour rÃ©initialiser `localStorage` et Ã©viter les interfÃ©rences entre les tests.
2. **Simuler des actions utilisateur :**
   - Utilise `act` pour garantir que les mises Ã  jour de l'Ã©tat se font dans un environnement React contrÃ´lÃ©.
3. **Bonne pratique :**
   - ExÃ©cute les tests avec `npx vitest --run` pour vÃ©rifier que tout fonctionne comme prÃ©vu.

Fichiers

- `src/app/__tests__/units/theme.test.tsx`

###

## Aller plus loin

ğŸ“‘ Le lien vers la doc [https://testing-library.com/docs/queries/about/](https://testing-library.com/docs/queries/about/)

## Ils vont tâ€™aider

- **ğŸ¶ Mowgli le Chien** : _Mowgli te guidera dans chaque exercice._
- **ğŸ¤– Ash le Robot** : _Ash le Robot te donnera du code utile._
- **ğŸš€ Julia La roquette** : _Julia te donnera des dÃ©fis supplÃ©mentaires._
- **â›ï¸ Hulk le Marteau** : _Quand du code Ã  supprimer est prÃ©sent_
- **ğŸ‘¨â€âœˆï¸ Hugo le chef de projet** : _Va t'aider sur les spÃ©cifications du projet_

## ğŸœ Feedback

Remplir le formulaire le [formulaire de FeedBack](https://go.mikecodeur.com/cours-next-avis?entry.1912869708=Next%20Mastery&entry.1430994900=8.Next%20Testing&entry.533578441=02%20Tests-component).
